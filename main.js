!function(){"use strict";class e{constructor(e,t){let{items:n,renderer:s}=e;this._items=n,this._renderer=s,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class t{constructor(e,t,n,s,r,i){this._name=e.name,this._link=e.link,this._cardSelector=t,this._popupWithImage=n,this._handleCardClick=s,this._handleDeleteCallback=r,this._api=i,this._id=e._id,this._isLiked=e.isLiked}_setEventListeners(){this._deleteButton=this._cardElement.querySelector(".content__card-delete-button"),this._imageContainer=this._cardElement.querySelector(".content__card-image"),this._cardImage.addEventListener("click",(()=>{this._handleImageClick()})),this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCallback(this._cardElement)}))}_handleLikeIcon(){this._likeButton.classList.contains("content__card-like-button_clicked")?this._api.removeLike(this._id).then((()=>{this._likeButton.classList.remove("content__card-like-button_clicked")})).catch((e=>{console.error("Error removing like:",e)})):this._api.addLike(this._id).then((()=>{this._likeButton.classList.add("content__card-like-button_clicked")})).catch((e=>{console.error("error adding like:",e)}))}_handleImageClick(){this._handleCardClick(this._name,this._link)}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".content__card").cloneNode(!0),this._cardTitle=this._cardElement.querySelector(".content__card-text"),this._cardImage=this._cardElement.querySelector(".content__card-image"),this._likeButton=this._cardElement.querySelector(".content__card-like-button"),this._renderCard(),this._setEventListeners(),this._cardElement}_renderCard(){this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._isLiked?this._likeButton.classList.add("content__card-like-button_clicked"):this._likeButton.classList.remove("content__card-like-button_clicked")}}class n{constructor(e,t){this._formElement=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButton=this._formElement.querySelector(e.submitButtonSelector),this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)]}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=""}_checkFormValidity(){return this._inputElements.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const s=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button"),i=(document.querySelector('input[name="name"]'),document.querySelector('input[name="description"]'),document.querySelector(".profile__info-name"),document.querySelector(".profile__info-description"),document.querySelector(".profile__picture_edit_button"));document.querySelector('input[name="title"]'),document.querySelector('input[name="link"]');class o{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this.closeModalByEscape),document.addEventListener("click",this.closeModalOnRemoteClick)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this.closeModalByEscape),document.removeEventListener("click",this.closeModalOnRemoteClick)}closeModalByEscape=e=>{"Escape"===e.key&&this.close()};closeModalOnRemoteClick=e=>{e.target.classList.contains("modal_opened")&&this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__exit-button"),this._closeButton.addEventListener("click",(()=>this.close()))}}class a extends o{constructor(e,t){super({popupSelector:e}),this._handleSubmit=t,this._form=this._popupElement.querySelector("form"),this._button=this._form.querySelector("button"),this._submitButtonText=this._button.textContent,this._inputList=[...this._form.querySelectorAll("input")]}reset(){this._form&&this._form.reset()}close=()=>{super.close(),this.reset()};_getInputValues(){const e={};for(const t of this._inputList)e[t.name]=t.value;return e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._button.textContent=e?t:this._submitButtonText}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues())}))}}const l={};let c;function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.renderLoading(!0,n),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.renderLoading(!1)}))}const d=e=>{const n=new t(e,"#card-template",m,((e,t)=>m.open(e,t)),(t=>{f.open(t,e._id)}),h);c.addItem(n.getView())},h=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._url}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._url}/users/me`,{headers:this._headers})}updateUserInfo(e){return this._request(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}updateAvatar(e){return this._request(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}addNewCard(e){return this._request(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}getInitialData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}deleteCard(e){return this._request(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers})}addLike(e){return this._request(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}removeLike(e){return this._request(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d56fe388-1e54-4c89-a64c-cf770afe6bc4","Content-Type":"application/json"}});h.getUserInfo().then((e=>{_.setUserInfo({name:e.name,about:e.about,avatar:e.avatar})})).catch((e=>{console.error("Error fetching user data:",e)})),h.getInitialCards().then((t=>{c=new e({items:t.reverse(),renderer:d},".content"),c.renderItems()})).catch((e=>{console.error("Error fetching cards:",e)}));const _=new class{constructor(e){let{nameSelector:t,aboutSelector:n,avatarSelector:s}=e;this._nameElement=document.querySelector(t),this._aboutElement=document.querySelector(n),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,about:n,avatar:s}=e;this._nameElement.textContent=t,this._aboutElement.textContent=n,this._avatarElement.src=s}}({nameSelector:".profile__info-name",aboutSelector:".profile__info-description",avatarSelector:".profile__picture"}),m=new class extends o{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._imagePreview=this._popupElement.querySelector(".modal__card-image"),this._imagePreviewTitle=this._popupElement.querySelector(".modal__image-title")}open(e,t){this._imagePreview.src=t,this._imagePreview.alt=e,this._imagePreviewTitle.textContent=e,super.open()}}({popupSelector:"#image-popup"}),p=new a("#edit_profile_modal",(e=>{let{name:t,about:n}=e;return function(e,t){u((function(){return h.updateUserInfo({name:e,about:t}).then((e=>{_.setUserInfo({name:e.name,about:e.about,avatar:e.avatar})}))}),p)}(t,n)})),E=new a("#change_avatar",(e=>{let{link:t}=e;return function(e){u((function(){return h.updateAvatar(e).then((e=>{_.setUserInfo(e)}))}),E)}(t)})),v=new a("#add_image_modal",(e=>{let{title:t,link:n}=e;!function(e,t){u((function(){return h.addNewCard({name:e,link:t}).then(d)}),v)}(t,n)})),f=new class extends o{constructor(e,t){super({popupSelector:e}),this._handleSubmit=t,this._form=this._popupElement.querySelector("form"),this._button=this._form.querySelector("button"),this._submitButtonText=this._button.textContent}open(e,t){this._cardElement=e,this._cardID=t,super.open()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Removing...";this._button.textContent=e?t:this._submitButtonText}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._cardElement,this._cardID)}))}}("#delete-popup",(function(e,t){u((function(){return h.deleteCard(t).then((()=>{e.remove(),e=null}))}),f)}));var b;f.setEventListeners(),p.setEventListeners(),v.setEventListeners(),m.setEventListeners(),E.setEventListeners(),b={formSelector:".modal__form",inputSelector:".modal__form-input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button-inactive",inputErrorClass:"modal__input_type_error"},[...document.querySelectorAll(b.formSelector)].forEach((e=>{const t=new n(b,e),s=e.getAttribute("name");l[s]=t,t.enableValidation()})),s.addEventListener("click",(()=>{l["profile-form"].resetValidation(),(()=>{const{name:e,about:t}=_.getUserInfo();p.setInputValues({name:e,about:t})})(),p.open()})),i.addEventListener("click",(()=>{l["change-avatar-form"].resetValidation(),E.open()})),r.addEventListener("click",(()=>{l["add-image-form"].resetValidation(),v.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0NBQ3JCRSxnQkFBaUIsMkJHVkEsSUFBSW5FLFNBQVNxRSxpQkFBaUJkLEVBQVNJLGVBQy9DckQsU0FBU2tELElBQ2hCLE1BQU13SSxFQUFZLElBQUkxSSxFQUFjQyxFQUFVQyxHQUN4Q3lJLEVBQVd6SSxFQUFZMEksYUFBYSxRQUMxQ3ZFLEVBQWVzRSxHQUFZRCxFQUMzQkEsRUFBVTNHLGtCQUFrQixJQWlKaENHLEVBQVd6RCxpQkFBaUIsU0FBUyxLQUNuQzRGLEVBQWUsZ0JBQWdCdkMsa0JBdkdOK0csTUFDekIsTUFBTSxLQUFFcEwsRUFBSSxNQUFFZ0osR0FBVVMsRUFBU2hCLGNBQ2pDK0IsRUFBaUI5RCxlQUFlLENBQUUxRyxPQUFNZ0osU0FBUSxFQXNHaERvQyxHQUNBWixFQUFpQnpGLE1BQU0sSUFHekJKLEVBQWlCM0QsaUJBQWlCLFNBQVMsS0FDekM0RixFQUFlLHNCQUFzQnZDLGtCQUNyQ3NHLEVBQWdCNUYsTUFBTSxJQUd4QkwsRUFBZTFELGlCQUFpQixTQUFTLEtBQ3ZDNEYsRUFBZSxrQkFBa0J2QyxrQkFDakN3RyxFQUFjOUYsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBjYXJkRGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgcG9wdXBXaXRoSW1hZ2UsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNhbGxiYWNrLFxuICAgIGFwaUluc3RhbmNlXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9wb3B1cFdpdGhJbWFnZSA9IHBvcHVwV2l0aEltYWdlO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYWxsYmFjayA9IGhhbmRsZURlbGV0ZUNhbGxiYWNrO1xuICAgIHRoaXMuX2FwaSA9IGFwaUluc3RhbmNlO1xuICAgIHRoaXMuX2lkID0gY2FyZERhdGEuX2lkO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBjYXJkRGF0YS5pc0xpa2VkO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vZGVmaW5lIGVsZW1lbnRzXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNvbnRlbnRfX2NhcmQtZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9pbWFnZUNvbnRhaW5lciA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jb250ZW50X19jYXJkLWltYWdlXCJcbiAgICApO1xuXG4gICAgLy9ldmVudCBsaXN0ZW5lcnNcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhbGxiYWNrKHRoaXMuX2NhcmRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNvbnRlbnRfX2NhcmQtbGlrZS1idXR0b25fY2xpY2tlZFwiKVxuICAgICkge1xuICAgICAgdGhpcy5fYXBpXG4gICAgICAgIC5yZW1vdmVMaWtlKHRoaXMuX2lkKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFxuICAgICAgICAgICAgXCJjb250ZW50X19jYXJkLWxpa2UtYnV0dG9uX2NsaWNrZWRcIlxuICAgICAgICAgICk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJlbW92aW5nIGxpa2U6XCIsIGVycik7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9hcGlcbiAgICAgICAgLmFkZExpa2UodGhpcy5faWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjb250ZW50X19jYXJkLWxpa2UtYnV0dG9uX2NsaWNrZWRcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcImVycm9yIGFkZGluZyBsaWtlOlwiLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlSW1hZ2VDbGljaygpIHtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudF9fY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudF9fY2FyZC10ZXh0XCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudF9fY2FyZC1pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNvbnRlbnRfX2NhcmQtbGlrZS1idXR0b25cIlxuICAgICk7XG5cbiAgICAvL2NhbGwgcHJldmlvdXNseSBkZWZpbmVkIG1ldGhvZHNcbiAgICB0aGlzLl9yZW5kZXJDYXJkKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuXG4gIC8vcmVuZGVyIGNhcmRcbiAgX3JlbmRlckNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjb250ZW50X19jYXJkLWxpa2UtYnV0dG9uX2NsaWNrZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNvbnRlbnRfX2NhcmQtbGlrZS1idXR0b25fY2xpY2tlZFwiKTtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gW1xuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcbiAgICBdO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfY2hlY2tGb3JtVmFsaWRpdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGlzRm9ybVZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcbiAgICBpZiAoaXNGb3JtVmFsaWQpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZEltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJuYW1lXCJdJyk7XG5leHBvcnQgY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICdpbnB1dFtuYW1lPVwiZGVzY3JpcHRpb25cIl0nXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbmZvLW5hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9faW5mby1kZXNjcmlwdGlvblwiXG4pO1xuXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX3BpY3R1cmVfZWRpdF9idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybS1pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbi1pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbn07XG5cbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJ0aXRsZVwiXScpO1xuZXhwb3J0IGNvbnN0IGNhcmRMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibGlua1wiXScpO1xuZXhwb3J0IGNvbnN0IGNhcmRMaXN0U2VsZWN0b3IgPSBcIi5jb250ZW50XCI7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5jbG9zZU1vZGFsQnlFc2NhcGUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlTW9kYWxPblJlbW90ZUNsaWNrKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmNsb3NlTW9kYWxCeUVzY2FwZSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2spO1xuICB9XG5cbiAgY2xvc2VNb2RhbEJ5RXNjYXBlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIGNsb3NlTW9kYWxPblJlbW90ZUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19leGl0LWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJmb3JtXCIpO1xuICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fYnV0dG9uLnRleHRDb250ZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKV07XG4gIH1cblxuICByZXNldCgpIHtcbiAgICBpZiAodGhpcy5fZm9ybSkge1xuICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIH1cbiAgfVxuXG4gIGNsb3NlID0gKCkgPT4ge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5yZXNldCgpO1xuICB9O1xuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIGZvciAoY29uc3QgaW5wdXQgb2YgdGhpcy5faW5wdXRMaXN0KSB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG59XG4iLCIvL2ltcG9ydCBhbGwgdGhlIGNsYXNzZXNcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHtcbiAgZWRpdEJ1dHRvbixcbiAgYWRkSW1hZ2VCdXR0b24sXG4gIHNldHRpbmdzLFxuICBjYXJkTGlzdFNlbGVjdG9yLFxuICBlZGl0QXZhdGFyQnV0dG9uLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhEZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlXCI7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5sZXQgY2FyZFNlY3Rpb247XG5cbi8vZnVuY3Rpb25cblxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICBwb3B1cEluc3RhbmNlLnJlbmRlckxvYWRpbmcodHJ1ZSwgbG9hZGluZ1RleHQpO1xuICByZXF1ZXN0KClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBwb3B1cEluc3RhbmNlLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwb3B1cEluc3RhbmNlLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKV07XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufTtcblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VGb3JtU3VibWl0KG5hbWUsIGxpbmspIHtcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XG4gICAgcmV0dXJuIGFwaS5hZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KS50aGVuKHJlbmRlckNhcmQpO1xuICB9XG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgYWRkSW1hZ2VQb3B1cCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KG5hbWUsIGFib3V0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGkudXBkYXRlVXNlckluZm8oeyBuYW1lLCBhYm91dCB9KS50aGVuKCh1cGRhdGVkVXNlcikgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lOiB1cGRhdGVkVXNlci5uYW1lLFxuICAgICAgICBhYm91dDogdXBkYXRlZFVzZXIuYWJvdXQsXG4gICAgICAgIGF2YXRhcjogdXBkYXRlZFVzZXIuYXZhdGFyLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBlZGl0UHJvZmlsZVBvcHVwKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGxpbmspIHtcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XG4gICAgcmV0dXJuIGFwaS51cGRhdGVBdmF0YXIobGluaykudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgICB9KTtcbiAgfVxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRBdmF0YXJQb3B1cCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbihjYXJkRWxlbWVudCwgY2FyZElEKSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGkuZGVsZXRlQ2FyZChjYXJkSUQpLnRoZW4oKCkgPT4ge1xuICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICBjYXJkRWxlbWVudCA9IG51bGw7XG4gICAgfSk7XG4gIH1cbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBkZWxldGVJbWFnZVBvcHVwKTtcbn1cblxuY29uc3Qgc2V0RWRpdFBvcHVwVmFsdWVzID0gKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBlZGl0UHJvZmlsZVBvcHVwLnNldElucHV0VmFsdWVzKHsgbmFtZSwgYWJvdXQgfSk7XG59O1xuXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmREYXRhKSA9PiB7XG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaW1hZ2VQb3B1cCxcbiAgICAodGl0bGUsIGxpbmspID0+IGltYWdlUG9wdXAub3Blbih0aXRsZSwgbGluayksXG4gICAgKGNhcmRFbGVtZW50KSA9PiB7XG4gICAgICBkZWxldGVJbWFnZVBvcHVwLm9wZW4oY2FyZEVsZW1lbnQsIGNhcmREYXRhLl9pZCk7XG4gICAgfSxcbiAgICBhcGlcbiAgKTtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkLmdldFZpZXcoKSk7XG59O1xuLy8gICAgICAgICAgICAgICAgICAvL1xuLy9BcGkgaW50ZWdyYXRpb25cbi8vICAgICAgICAgICAgICAgICAgLy9cblxuLy9hcGkgY2xhc3NcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImQ1NmZlMzg4LTFlNTQtNGM4OS1hNjRjLWNmNzcwYWZlNmJjNFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vQXBpIFVzZXIgSW5mbyBGZXRjaCBSZXF1ZXN0XG5hcGlcbiAgLmdldFVzZXJJbmZvKClcbiAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcbiAgICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcbiAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGRhdGE6XCIsIGVycik7XG4gIH0pO1xuXG4vL0FwaSBDYXJkIEZldGNoIFJlcXVlc3RcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigoY2FyZHMpID0+IHtcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZHMucmV2ZXJzZSgpLFxuICAgICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcbiAgICAgIH0sXG4gICAgICBjYXJkTGlzdFNlbGVjdG9yXG4gICAgKTtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBjYXJkczpcIiwgZXJyKTtcbiAgfSk7XG5cbi8vIEluc3RuYXRpYXRlIGVsZW1lbnRzXG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19pbmZvLW5hbWVcIixcbiAgYWJvdXRTZWxlY3RvcjogXCIucHJvZmlsZV9faW5mby1kZXNjcmlwdGlvblwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fcGljdHVyZVwiLFxufSk7XG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoeyBwb3B1cFNlbGVjdG9yOiBcIiNpbWFnZS1wb3B1cFwiIH0pO1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2VkaXRfcHJvZmlsZV9tb2RhbFwiLFxuICAoeyBuYW1lLCBhYm91dCB9KSA9PiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChuYW1lLCBhYm91dClcbik7XG5cbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2NoYW5nZV9hdmF0YXJcIiwgKHsgbGluayB9KSA9PlxuICBoYW5kbGVBdmF0YXJTdWJtaXQobGluaylcbik7XG5cbmNvbnN0IGFkZEltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjYWRkX2ltYWdlX21vZGFsXCIsXG4gICh7IHRpdGxlLCBsaW5rIH0pID0+IHtcbiAgICBoYW5kbGVJbWFnZUZvcm1TdWJtaXQodGl0bGUsIGxpbmspO1xuICB9XG4pO1xuY29uc3QgZGVsZXRlSW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhEZWxldGUoXG4gIFwiI2RlbGV0ZS1wb3B1cFwiLFxuICBoYW5kbGVEZWxldGVDb25maXJtYXRpb25cbik7XG5kZWxldGVJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGRJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG5cbi8vc3BlY2lmaWMgZXZlbnQgbGlzdGVuZXJzXG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHNldEVkaXRQb3B1cFZhbHVlcygpO1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbn0pO1xuXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW1wiY2hhbmdlLWF2YXRhci1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBlZGl0QXZhdGFyUG9wdXAub3BlbigpO1xufSk7XG5cbmFkZEltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW1wiYWRkLWltYWdlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGFkZEltYWdlUG9wdXAub3BlbigpO1xufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8odXNlckRhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogdXNlckRhdGEuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUF2YXRhcihsaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogbGluayxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogY2FyZERhdGEubmFtZSxcbiAgICAgICAgbGluazogY2FyZERhdGEubGluayxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbERhdGEoKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJRH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgYWRkTGlrZShjYXJkSUQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICByZW1vdmVMaWtlKGNhcmRJRCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSUR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2ltYWdlUHJldmlldyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXJkLWltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlUHJldmlld1RpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9faW1hZ2UtdGl0bGVcIlxuICAgICk7XG4gIH1cblxuICBvcGVuKGNhcmROYW1lLCBjYXJkTGluaykge1xuICAgIHRoaXMuX2ltYWdlUHJldmlldy5zcmMgPSBjYXJkTGluaztcbiAgICB0aGlzLl9pbWFnZVByZXZpZXcuYWx0ID0gY2FyZE5hbWU7XG4gICAgdGhpcy5faW1hZ2VQcmV2aWV3VGl0bGUudGV4dENvbnRlbnQgPSBjYXJkTmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCJidXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIG9wZW4oY2FyZEVsZW1lbnQsIGNhcmRJRCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQ7XG4gICAgdGhpcy5fY2FyZElEID0gY2FyZElEO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiUmVtb3ZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fY2FyZEVsZW1lbnQsIHRoaXMuX2NhcmRJRCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJTZWN0aW9uIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwidGhpcyIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJDYXJkIiwiY2FyZERhdGEiLCJjYXJkU2VsZWN0b3IiLCJwb3B1cFdpdGhJbWFnZSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhbGxiYWNrIiwiYXBpSW5zdGFuY2UiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX3BvcHVwV2l0aEltYWdlIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDYWxsYmFjayIsIl9hcGkiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiX2ltYWdlQ29udGFpbmVyIiwiX2NhcmRJbWFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9saWtlQnV0dG9uIiwiX2hhbmRsZUxpa2VJY29uIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJyZW1vdmVMaWtlIiwidGhlbiIsInJlbW92ZSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYWRkTGlrZSIsImFkZCIsImdldFZpZXciLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZSIsIl9yZW5kZXJDYXJkIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2lucHV0RWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJldmVyeSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVkIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZWRpdEJ1dHRvbiIsImFkZEltYWdlQnV0dG9uIiwiZWRpdEF2YXRhckJ1dHRvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiY2xvc2VNb2RhbEJ5RXNjYXBlIiwiY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2siLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJzZXRFdmVudExpc3RlbmVycyIsIl9jbG9zZUJ1dHRvbiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2Zvcm0iLCJfYnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfaW5wdXRMaXN0IiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwiZm9ybVZhbGlkYXRvcnMiLCJjYXJkU2VjdGlvbiIsImhhbmRsZVN1Ym1pdCIsInJlcXVlc3QiLCJwb3B1cEluc3RhbmNlIiwiZmluYWxseSIsInJlbmRlckNhcmQiLCJuZXdDYXJkIiwiaW1hZ2VQb3B1cCIsInRpdGxlIiwiY2FyZEVsZW1lbnQiLCJkZWxldGVJbWFnZVBvcHVwIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJmZXRjaCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwidXBkYXRlVXNlckluZm8iLCJ1c2VyRGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJhZGROZXdDYXJkIiwiZ2V0SW5pdGlhbERhdGEiLCJhbGwiLCJkZWxldGVDYXJkIiwiY2FyZElEIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJjYXJkcyIsInJldmVyc2UiLCJuYW1lU2VsZWN0b3IiLCJhYm91dFNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfYWJvdXRFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJfcmVmMiIsIl9pbWFnZVByZXZpZXciLCJfaW1hZ2VQcmV2aWV3VGl0bGUiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwiZWRpdFByb2ZpbGVQb3B1cCIsInVwZGF0ZWRVc2VyIiwiaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQiLCJlZGl0QXZhdGFyUG9wdXAiLCJoYW5kbGVBdmF0YXJTdWJtaXQiLCJhZGRJbWFnZVBvcHVwIiwiX3JlZjMiLCJoYW5kbGVJbWFnZUZvcm1TdWJtaXQiLCJfY2FyZElEIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJzZXRFZGl0UG9wdXBWYWx1ZXMiXSwic291cmNlUm9vdCI6IiJ9